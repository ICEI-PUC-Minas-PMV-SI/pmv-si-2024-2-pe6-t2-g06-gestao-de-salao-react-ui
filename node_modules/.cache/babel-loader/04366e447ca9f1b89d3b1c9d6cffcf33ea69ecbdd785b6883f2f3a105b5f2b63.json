{"ast":null,"code":"var _jsxFileName = \"C:\\\\ProjetoSalao\\\\pmv-si-2024-2-pe6-t2-g06-gestao-de-salao-react-ui\\\\src\\\\Pages\\\\Context\\\\useAuth.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { loginAPI, registerAPI } from \"../Services/AuthService\";\nimport { toast } from \"react-toastify\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext({});\nexport const UserProvider = ({\n  children\n}) => {\n  _s();\n  const navigate = useNavigate();\n  const [token, setToken] = useState(null);\n  const [user, setUser] = useState(null);\n  const [isReady, setIsReady] = useState(false);\n  useEffect(() => {\n    const user = localStorage.getItem(\"user\");\n    const token = localStorage.getItem(\"token\");\n    if (user && token) {\n      setUser(JSON.parse(user));\n      setToken(token);\n      axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + token;\n    }\n    setIsReady(true);\n  }, []);\n  const registerUser = async (email, username, password) => {\n    await registerAPI(email, username, password).then(res => {\n      if (res) {\n        localStorage.setItem(\"token\", res === null || res === void 0 ? void 0 : res.data.token);\n        const userObj = {\n          userName: res === null || res === void 0 ? void 0 : res.data.userName,\n          email: res === null || res === void 0 ? void 0 : res.data.email\n        };\n        localStorage.setItem(\"user\", JSON.stringify(userObj));\n        setToken(res === null || res === void 0 ? void 0 : res.data.token);\n        setUser(userObj);\n        toast.success(\"Login Success!\");\n        navigate(\"/search\");\n      }\n    }).catch(e => toast.warning(\"Server error occured\"));\n  };\n  const loginUser = async (username, password) => {\n    await loginAPI(username, password).then(res => {\n      if (res) {\n        localStorage.setItem(\"token\", res === null || res === void 0 ? void 0 : res.data.token);\n        const userObj = {\n          userName: res === null || res === void 0 ? void 0 : res.data.userName,\n          email: res === null || res === void 0 ? void 0 : res.data.email\n        };\n        localStorage.setItem(\"user\", JSON.stringify(userObj));\n        setToken(res === null || res === void 0 ? void 0 : res.data.token);\n        setUser(userObj);\n        toast.success(\"Login Success!\");\n        navigate(\"/search\");\n      }\n    }).catch(e => toast.warning(\"Server error occured\"));\n  };\n  const isLoggedIn = () => {\n    return !!user;\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    setUser(null);\n    setToken(\"\");\n    navigate(\"/\");\n  };\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      loginUser,\n      user,\n      token,\n      logout,\n      isLoggedIn,\n      registerUser\n    },\n    children: isReady ? children : null\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n};\n_s(UserProvider, \"A267/A8Ei/3Lm9oqvFzwbRuflcs=\", false, function () {\n  return [useNavigate];\n});\n_c = UserProvider;\nexport const useAuth = () => {\n  _s2();\n  return React.useContext(UserContext);\n};\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","useNavigate","loginAPI","registerAPI","toast","React","axios","jsxDEV","_jsxDEV","UserContext","UserProvider","children","_s","navigate","token","setToken","user","setUser","isReady","setIsReady","localStorage","getItem","JSON","parse","defaults","headers","common","registerUser","email","username","password","then","res","setItem","data","userObj","userName","stringify","success","catch","e","warning","loginUser","isLoggedIn","logout","removeItem","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","useContext","$RefreshReg$"],"sources":["C:/ProjetoSalao/pmv-si-2024-2-pe6-t2-g06-gestao-de-salao-react-ui/src/Pages/Context/useAuth.tsx"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\r\nimport { UserProfile } from \"../Models/User\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { loginAPI, registerAPI } from \"../Services/AuthService\";\r\nimport { toast } from \"react-toastify\";\r\nimport React from \"react\";\r\nimport axios from \"axios\";\r\n\r\ntype UserContextType = {\r\n  user: UserProfile | null;\r\n  token: string | null;\r\n  registerUser: (email: string, username: string, password: string) => void;\r\n  loginUser: (username: string, password: string) => void;\r\n  logout: () => void;\r\n  isLoggedIn: () => boolean;\r\n};\r\n\r\ntype Props = { children: React.ReactNode };\r\n\r\nconst UserContext = createContext<UserContextType>({} as UserContextType);\r\n\r\nexport const UserProvider = ({ children }: Props) => {\r\n  const navigate = useNavigate();\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [user, setUser] = useState<UserProfile | null>(null);\r\n  const [isReady, setIsReady] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const user = localStorage.getItem(\"user\");\r\n    const token = localStorage.getItem(\"token\");\r\n    if (user && token) {\r\n      setUser(JSON.parse(user));\r\n      setToken(token);\r\n      axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + token;\r\n    }\r\n    setIsReady(true);\r\n  }, []);\r\n\r\n  const registerUser = async (\r\n    email: string,\r\n    username: string,\r\n    password: string\r\n  ) => {\r\n    await registerAPI(email, username, password)\r\n      .then((res) => {\r\n        if (res) {\r\n          localStorage.setItem(\"token\", res?.data.token);\r\n          const userObj = {\r\n            userName: res?.data.userName,\r\n            email: res?.data.email,\r\n          };\r\n          localStorage.setItem(\"user\", JSON.stringify(userObj));\r\n          setToken(res?.data.token!);\r\n          setUser(userObj!);\r\n          toast.success(\"Login Success!\");\r\n          navigate(\"/search\");\r\n        }\r\n      })\r\n      .catch((e) => toast.warning(\"Server error occured\"));\r\n  };\r\n\r\n  const loginUser = async (username: string, password: string) => {\r\n    await loginAPI(username, password)\r\n      .then((res) => {\r\n        if (res) {\r\n          localStorage.setItem(\"token\", res?.data.token);\r\n          const userObj = {\r\n            userName: res?.data.userName,\r\n            email: res?.data.email,\r\n          };\r\n          localStorage.setItem(\"user\", JSON.stringify(userObj));\r\n          setToken(res?.data.token!);\r\n          setUser(userObj!);\r\n          toast.success(\"Login Success!\");\r\n          navigate(\"/search\");\r\n        }\r\n      })\r\n      .catch((e) => toast.warning(\"Server error occured\"));\r\n  };\r\n\r\n  const isLoggedIn = () => {\r\n    return !!user;\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"user\");\r\n    setUser(null);\r\n    setToken(\"\");\r\n    navigate(\"/\");\r\n  };\r\n\r\n  return (\r\n    <UserContext.Provider\r\n      value={{ loginUser, user, token, logout, isLoggedIn, registerUser }}\r\n    >\r\n      {isReady ? children : null}\r\n    </UserContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => React.useContext(UserContext);"],"mappings":";;;AAAA,SAASA,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAE1D,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,QAAQ,EAAEC,WAAW,QAAQ,yBAAyB;AAC/D,SAASC,KAAK,QAAQ,gBAAgB;AACtC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAa1B,MAAMC,WAAW,gBAAGX,aAAa,CAAkB,CAAC,CAAoB,CAAC;AAEzE,OAAO,MAAMY,YAAY,GAAGA,CAAC;EAAEC;AAAgB,CAAC,KAAK;EAAAC,EAAA;EACnD,MAAMC,QAAQ,GAAGZ,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACa,KAAK,EAAEC,QAAQ,CAAC,GAAGf,QAAQ,CAAgB,IAAI,CAAC;EACvD,MAAM,CAACgB,IAAI,EAAEC,OAAO,CAAC,GAAGjB,QAAQ,CAAqB,IAAI,CAAC;EAC1D,MAAM,CAACkB,OAAO,EAAEC,UAAU,CAAC,GAAGnB,QAAQ,CAAC,KAAK,CAAC;EAE7CD,SAAS,CAAC,MAAM;IACd,MAAMiB,IAAI,GAAGI,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IACzC,MAAMP,KAAK,GAAGM,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAIL,IAAI,IAAIF,KAAK,EAAE;MACjBG,OAAO,CAACK,IAAI,CAACC,KAAK,CAACP,IAAI,CAAC,CAAC;MACzBD,QAAQ,CAACD,KAAK,CAAC;MACfR,KAAK,CAACkB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,SAAS,GAAGZ,KAAK;IACpE;IACAK,UAAU,CAAC,IAAI,CAAC;EAClB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMQ,YAAY,GAAG,MAAAA,CACnBC,KAAa,EACbC,QAAgB,EAChBC,QAAgB,KACb;IACH,MAAM3B,WAAW,CAACyB,KAAK,EAAEC,QAAQ,EAAEC,QAAQ,CAAC,CACzCC,IAAI,CAAEC,GAAG,IAAK;MACb,IAAIA,GAAG,EAAE;QACPZ,YAAY,CAACa,OAAO,CAAC,OAAO,EAAED,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACpB,KAAK,CAAC;QAC9C,MAAMqB,OAAO,GAAG;UACdC,QAAQ,EAAEJ,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACE,QAAQ;UAC5BR,KAAK,EAAEI,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACN;QACnB,CAAC;QACDR,YAAY,CAACa,OAAO,CAAC,MAAM,EAAEX,IAAI,CAACe,SAAS,CAACF,OAAO,CAAC,CAAC;QACrDpB,QAAQ,CAACiB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACpB,KAAM,CAAC;QAC1BG,OAAO,CAACkB,OAAQ,CAAC;QACjB/B,KAAK,CAACkC,OAAO,CAAC,gBAAgB,CAAC;QAC/BzB,QAAQ,CAAC,SAAS,CAAC;MACrB;IACF,CAAC,CAAC,CACD0B,KAAK,CAAEC,CAAC,IAAKpC,KAAK,CAACqC,OAAO,CAAC,sBAAsB,CAAC,CAAC;EACxD,CAAC;EAED,MAAMC,SAAS,GAAG,MAAAA,CAAOb,QAAgB,EAAEC,QAAgB,KAAK;IAC9D,MAAM5B,QAAQ,CAAC2B,QAAQ,EAAEC,QAAQ,CAAC,CAC/BC,IAAI,CAAEC,GAAG,IAAK;MACb,IAAIA,GAAG,EAAE;QACPZ,YAAY,CAACa,OAAO,CAAC,OAAO,EAAED,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACpB,KAAK,CAAC;QAC9C,MAAMqB,OAAO,GAAG;UACdC,QAAQ,EAAEJ,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACE,QAAQ;UAC5BR,KAAK,EAAEI,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACN;QACnB,CAAC;QACDR,YAAY,CAACa,OAAO,CAAC,MAAM,EAAEX,IAAI,CAACe,SAAS,CAACF,OAAO,CAAC,CAAC;QACrDpB,QAAQ,CAACiB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEE,IAAI,CAACpB,KAAM,CAAC;QAC1BG,OAAO,CAACkB,OAAQ,CAAC;QACjB/B,KAAK,CAACkC,OAAO,CAAC,gBAAgB,CAAC;QAC/BzB,QAAQ,CAAC,SAAS,CAAC;MACrB;IACF,CAAC,CAAC,CACD0B,KAAK,CAAEC,CAAC,IAAKpC,KAAK,CAACqC,OAAO,CAAC,sBAAsB,CAAC,CAAC;EACxD,CAAC;EAED,MAAME,UAAU,GAAGA,CAAA,KAAM;IACvB,OAAO,CAAC,CAAC3B,IAAI;EACf,CAAC;EAED,MAAM4B,MAAM,GAAGA,CAAA,KAAM;IACnBxB,YAAY,CAACyB,UAAU,CAAC,OAAO,CAAC;IAChCzB,YAAY,CAACyB,UAAU,CAAC,MAAM,CAAC;IAC/B5B,OAAO,CAAC,IAAI,CAAC;IACbF,QAAQ,CAAC,EAAE,CAAC;IACZF,QAAQ,CAAC,GAAG,CAAC;EACf,CAAC;EAED,oBACEL,OAAA,CAACC,WAAW,CAACqC,QAAQ;IACnBC,KAAK,EAAE;MAAEL,SAAS;MAAE1B,IAAI;MAAEF,KAAK;MAAE8B,MAAM;MAAED,UAAU;MAAEhB;IAAa,CAAE;IAAAhB,QAAA,EAEnEO,OAAO,GAAGP,QAAQ,GAAG;EAAI;IAAAqC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACN,CAAC;AAE3B,CAAC;AAACvC,EAAA,CA9EWF,YAAY;EAAA,QACNT,WAAW;AAAA;AAAAmD,EAAA,GADjB1C,YAAY;AAgFzB,OAAO,MAAM2C,OAAO,GAAGA,CAAA;EAAAC,GAAA;EAAA,OAAMjD,KAAK,CAACkD,UAAU,CAAC9C,WAAW,CAAC;AAAA;AAAC6C,GAAA,CAA9CD,OAAO;AAAA,IAAAD,EAAA;AAAAI,YAAA,CAAAJ,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}